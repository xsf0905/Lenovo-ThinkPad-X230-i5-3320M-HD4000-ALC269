(function(){'use strict';function k(d){d.style.display="";d.focus()}
function m(d,f){function g(){document.getElementById("_dydlg_frame_").contentWindow.postMessage({cmd:"init",task:d,dlg_opts:f},"*")}!f&&q&&(f={fontSize:q.get("font_size"),useLastLocation:q.get("always_use_last_location"),taskDef:q.b(),canFileAccess:q.a()});var a=document.getElementById("_dydlg_frame_");if(a)k(document.getElementById("_dydlg_wrap_")),g();else{var b=document.getElementById("_dydlg_wrap_");b||(b=document.createElement("div"),b.id="_dydlg_wrap_",b.style.cssText="display:none;position:fixed;margin:0;bottom:0;left:0;right:0;top:0;opacity:1;-webkit-transition: opacity 0.2s;transition: opacity 0.2s;overflow: hidden;z-index: 9999;cursor: default;",
document.body.appendChild(b));var h=`${chrome.extension.getURL("/com/taskdlg.htm")}?page_title=${encodeURIComponent(document.title)}&fs=${f.fontSize}`;a=document.createElement("iframe");a.id="_dydlg_frame_";a.style.cssText="overflow:hidden;height:100%;width:100%;position:absolute;top:0;left:0;right:0;bottom:0;";a.scrolling="no";a.frameBorder="0";a.width="100%";a.height="100%";a.onload=g;a.src=h;b.appendChild(a);k(b);console.log("dlg injected")}}
window.addEventListener("message",function(d){"close_dlg"==d.data.cmd&&(document.getElementById("_dydlg_wrap_").style.display="none",window.focus(),document.activeElement&&document.activeElement.blur())},!1);var q;
(function(){var d=150,f=150;document.body.addEventListener("mousedown",function(a){if(1==a.which||3==a.which)f=a.clientY,d=a.clientX},!0);var g=[];chrome.runtime.onMessage.addListener(function(a,b,h){function n(c){c.target.classList.contains("danim_icon")&&"opacity"==c.propertyName&&c.target.parentNode.removeChild(c.target)}function r(c){var t=d-24,u=f-24;c=chrome.extension.getURL(c?"/icons/newd_pause.png":"/icons/newd.png");var e=document.createElement("div");e.className="danim_icon";e.style.cssText="position:fixed;opacity:1;width:48px;height:48px;z-index:9999;left:"+
t+"px;top:"+u+'px;background-image:url("'+c+'");background-size:contain;transition: opacity 500ms ease-out,transform 700ms ease-out';document.body.appendChild(e);e.addEventListener("transitionend",n);e.addEventListener("webkitTransitionEnd",n);window.getComputedStyle(e).opacity;window.getComputedStyle(e).transform;e.style.opacity="0";e.style.transform="scale(1.5)"}switch(a.cmd){case "g_links":b=[];h={};for(var l=0,v=g.length;l<v;++l){var p=g[l].url;void 0==h[p]&&(b.push(g[l]),h[p]=1)}0<b.length&&
chrome.runtime.sendMessage({cmd:"add_links",data:b});break;case "stream_url":a.url&&(b={url:a.url,size:a.size},b.desc=a.desc||document.title,a.fext&&(b.fext=a.fext),g.push(b),a.need_send&&chrome.runtime.sendMessage({cmd:"add_links",data:[b]}));break;case "d_one":chrome.runtime.sendMessage({cmd:"dlg_options"},function(c){m(a.task,c||{})});h("y");break;case "g_title":h(document.title);break;case "d_anim":r(a.addpause)}})})();}).call(this);
